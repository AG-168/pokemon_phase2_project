!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e||self).core=t()}(this,function(){var e=setTimeout;function t(e){return Boolean(e&&void 0!==e.length)}function n(){}function r(e){if(!(this instanceof r))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(e,this)}function o(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,r._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(e){return void i(t.promise,e)}a(t.promise,r)}else(1===e._state?a:i)(t.promise,e._value)})):e._deferreds.push(t)}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof r)return e._state=3,e._value=t,void s(e);if("function"==typeof n)return void c((o=n,a=t,function(){o.apply(a,arguments)}),e)}e._state=1,e._value=t,s(e)}catch(t){i(e,t)}var o,a}function i(e,t){e._state=2,e._value=t,s(e)}function s(e){2===e._state&&0===e._deferreds.length&&r._immediateFn(function(){e._handled||r._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)o(e,e._deferreds[t]);e._deferreds=null}function u(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function c(e,t){var n=!1;try{e(function(e){n||(n=!0,a(t,e))},function(e){n||(n=!0,i(t,e))})}catch(e){if(n)return;n=!0,i(t,e)}}r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){var r=new this.constructor(n);return o(this,new u(e,t,r)),r},r.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){return t.reject(n)})})},r.all=function(e){return new r(function(n,r){if(!t(e))return r(new TypeError("Promise.all accepts an array"));var o=Array.prototype.slice.call(e);if(0===o.length)return n([]);var a=o.length;function i(e,t){try{if(t&&("object"==typeof t||"function"==typeof t)){var s=t.then;if("function"==typeof s)return void s.call(t,function(t){i(e,t)},r)}o[e]=t,0==--a&&n(o)}catch(e){r(e)}}for(var s=0;s<o.length;s++)i(s,o[s])})},r.allSettled=function(e){return new this(function(t,n){if(!e||void 0===e.length)return n(new TypeError(typeof e+" "+e+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var o=r.length;function a(e,n){if(n&&("object"==typeof n||"function"==typeof n)){var i=n.then;if("function"==typeof i)return void i.call(n,function(t){a(e,t)},function(n){r[e]={status:"rejected",reason:n},0==--o&&t(r)})}r[e]={status:"fulfilled",value:n},0==--o&&t(r)}for(var i=0;i<r.length;i++)a(i,r[i])})},r.resolve=function(e){return e&&"object"==typeof e&&e.constructor===r?e:new r(function(t){t(e)})},r.reject=function(e){return new r(function(t,n){n(e)})},r.race=function(e){return new r(function(n,o){if(!t(e))return o(new TypeError("Promise.race accepts an array"));for(var a=0,i=e.length;a<i;a++)r.resolve(e[a]).then(n,o)})},r._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(t){e(t,0)},r._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var f=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}},d=Object.prototype.toString;function l(e){return"[object Array]"===d.call(e)}function h(e){return void 0===e}function p(e){return null!==e&&"object"==typeof e}function v(e){if("[object Object]"!==d.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function m(e){return"[object Function]"===d.call(e)}function w(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),l(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}var g={isArray:l,isArrayBuffer:function(e){return"[object ArrayBuffer]"===d.call(e)},isBuffer:function(e){return null!==e&&!h(e)&&null!==e.constructor&&!h(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:p,isPlainObject:v,isUndefined:h,isDate:function(e){return"[object Date]"===d.call(e)},isFile:function(e){return"[object File]"===d.call(e)},isBlob:function(e){return"[object Blob]"===d.call(e)},isFunction:m,isStream:function(e){return p(e)&&m(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:w,merge:function e(){var t={};function n(n,r){t[r]=v(t[r])&&v(n)?e(t[r],n):v(n)?e({},n):l(n)?n.slice():n}for(var r=0,o=arguments.length;r<o;r++)w(arguments[r],n);return t},extend:function(e,t,n){return w(t,function(t,r){e[r]=n&&"function"==typeof t?f(t,n):t}),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}};function y(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var k=function(e,t,n){if(!t)return e;var r;if(n)r=n(t);else if(g.isURLSearchParams(t))r=t.toString();else{var o=[];g.forEach(t,function(e,t){null!=e&&(g.isArray(e)?t+="[]":e=[e],g.forEach(e,function(e){g.isDate(e)?e=e.toISOString():g.isObject(e)&&(e=JSON.stringify(e)),o.push(y(t)+"="+y(e))}))}),r=o.join("&")}if(r){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e};function b(){this.handlers=[]}b.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},b.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},b.prototype.forEach=function(e){g.forEach(this.handlers,function(t){null!==t&&e(t)})};var j=b,E=function(e,t){g.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})},T=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e},x=function(e,t,n,r,o){var a=new Error(e);return T(a,t,n,r,o)},C=g.isStandardBrowserEnv()?{write:function(e,t,n,r,o,a){var i=[];i.push(e+"="+encodeURIComponent(t)),g.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),g.isString(r)&&i.push("path="+r),g.isString(o)&&i.push("domain="+o),!0===a&&i.push("secure"),document.cookie=i.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},O=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"],N=g.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=g.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0},S={"Content-Type":"application/x-www-form-urlencoded"};function U(e,t){!g.isUndefined(e)&&g.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var I,P={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(I=function(e){return new r(function(t,n){var r=e.data,o=e.headers,a=e.responseType;g.isFormData(r)&&delete o["Content-Type"];var i=new XMLHttpRequest;if(e.auth){var s=e.auth.username||"",u=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";o.Authorization="Basic "+btoa(s+":"+u)}var c,f,d=(f=e.url,(c=e.baseURL)&&!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(f)?function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}(c,f):f);function l(){if(i){var r,o,s,u,c,f="getAllResponseHeaders"in i?(r=i.getAllResponseHeaders(),c={},r?(g.forEach(r.split("\n"),function(e){if(u=e.indexOf(":"),o=g.trim(e.substr(0,u)).toLowerCase(),s=g.trim(e.substr(u+1)),o){if(c[o]&&O.indexOf(o)>=0)return;c[o]="set-cookie"===o?(c[o]?c[o]:[]).concat([s]):c[o]?c[o]+", "+s:s}}),c):c):null;!function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(x("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}(t,n,{data:a&&"text"!==a&&"json"!==a?i.response:i.responseText,status:i.status,statusText:i.statusText,headers:f,config:e,request:i}),i=null}}if(i.open(e.method.toUpperCase(),k(d,e.params,e.paramsSerializer),!0),i.timeout=e.timeout,"onloadend"in i?i.onloadend=l:i.onreadystatechange=function(){i&&4===i.readyState&&(0!==i.status||i.responseURL&&0===i.responseURL.indexOf("file:"))&&setTimeout(l)},i.onabort=function(){i&&(n(x("Request aborted",e,"ECONNABORTED",i)),i=null)},i.onerror=function(){n(x("Network Error",e,null,i)),i=null},i.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(x(t,e,e.transitional&&e.transitional.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",i)),i=null},g.isStandardBrowserEnv()){var h=(e.withCredentials||N(d))&&e.xsrfCookieName?C.read(e.xsrfCookieName):void 0;h&&(o[e.xsrfHeaderName]=h)}"setRequestHeader"in i&&g.forEach(o,function(e,t){void 0===r&&"content-type"===t.toLowerCase()?delete o[t]:i.setRequestHeader(t,e)}),g.isUndefined(e.withCredentials)||(i.withCredentials=!!e.withCredentials),a&&"json"!==a&&(i.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&i.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&i.upload&&i.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){i&&(i.abort(),n(e),i=null)}),r||(r=null),i.send(r)})}),I),transformRequest:[function(e,t){return E(t,"Accept"),E(t,"Content-Type"),g.isFormData(e)||g.isArrayBuffer(e)||g.isBuffer(e)||g.isStream(e)||g.isFile(e)||g.isBlob(e)?e:g.isArrayBufferView(e)?e.buffer:g.isURLSearchParams(e)?(U(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):g.isObject(e)||t&&"application/json"===t["Content-Type"]?(U(t,"application/json"),function(e,t,n){if(g.isString(e))try{return(0,JSON.parse)(e),g.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(0,JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional,n=!(t&&t.silentJSONParsing)&&"json"===this.responseType;if(n||t&&t.forcedJSONParsing&&g.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(n){if("SyntaxError"===e.name)throw T(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};g.forEach(["delete","get","head"],function(e){P.headers[e]={}}),g.forEach(["post","put","patch"],function(e){P.headers[e]=g.merge(S)});var R=P,A=function(e,t,n){var r=this||R;return g.forEach(n,function(n){e=n.call(r,e,t)}),e},_=function(e){return!(!e||!e.__CANCEL__)};function B(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var L=function(e){return B(e),e.headers=e.headers||{},e.data=A.call(e,e.data,e.headers,e.transformRequest),e.headers=g.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),g.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||R.adapter)(e).then(function(t){return B(e),t.data=A.call(e,t.data,t.headers,e.transformResponse),t},function(t){return _(t)||(B(e),t&&t.response&&(t.response.data=A.call(e,t.response.data,t.response.headers,e.transformResponse))),r.reject(t)})},D=function(e,t){t=t||{};var n={},r=["url","method","data"],o=["headers","auth","proxy","params"],a=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],i=["validateStatus"];function s(e,t){return g.isPlainObject(e)&&g.isPlainObject(t)?g.merge(e,t):g.isPlainObject(t)?g.merge({},t):g.isArray(t)?t.slice():t}function u(r){g.isUndefined(t[r])?g.isUndefined(e[r])||(n[r]=s(void 0,e[r])):n[r]=s(e[r],t[r])}g.forEach(r,function(e){g.isUndefined(t[e])||(n[e]=s(void 0,t[e]))}),g.forEach(o,u),g.forEach(a,function(r){g.isUndefined(t[r])?g.isUndefined(e[r])||(n[r]=s(void 0,e[r])):n[r]=s(void 0,t[r])}),g.forEach(i,function(r){r in t?n[r]=s(e[r],t[r]):r in e&&(n[r]=s(void 0,e[r]))});var c=r.concat(o).concat(a).concat(i),f=Object.keys(e).concat(Object.keys(t)).filter(function(e){return-1===c.indexOf(e)});return g.forEach(f,u),n},F={name:"axios",version:"0.21.4",description:"Promise based HTTP client for the browser and node.js",main:"index.js",scripts:{test:"grunt test",start:"node ./sandbox/server.js",build:"NODE_ENV=production grunt build",preversion:"npm test",version:"npm run build && grunt version && git add -A dist && git add CHANGELOG.md bower.json package.json",postversion:"git push && git push --tags",examples:"node ./examples/server.js",coveralls:"cat coverage/lcov.info | ./node_modules/coveralls/bin/coveralls.js",fix:"eslint --fix lib/**/*.js"},repository:{type:"git",url:"https://github.com/axios/axios.git"},keywords:["xhr","http","ajax","promise","node"],author:"Matt Zabriskie",license:"MIT",bugs:{url:"https://github.com/axios/axios/issues"},homepage:"https://axios-http.com",devDependencies:{coveralls:"^3.0.0","es6-promise":"^4.2.4",grunt:"^1.3.0","grunt-banner":"^0.6.0","grunt-cli":"^1.2.0","grunt-contrib-clean":"^1.1.0","grunt-contrib-watch":"^1.0.0","grunt-eslint":"^23.0.0","grunt-karma":"^4.0.0","grunt-mocha-test":"^0.13.3","grunt-ts":"^6.0.0-beta.19","grunt-webpack":"^4.0.2","istanbul-instrumenter-loader":"^1.0.0","jasmine-core":"^2.4.1",karma:"^6.3.2","karma-chrome-launcher":"^3.1.0","karma-firefox-launcher":"^2.1.0","karma-jasmine":"^1.1.1","karma-jasmine-ajax":"^0.1.13","karma-safari-launcher":"^1.0.0","karma-sauce-launcher":"^4.3.6","karma-sinon":"^1.0.5","karma-sourcemap-loader":"^0.3.8","karma-webpack":"^4.0.2","load-grunt-tasks":"^3.5.2",minimist:"^1.2.0",mocha:"^8.2.1",sinon:"^4.5.0","terser-webpack-plugin":"^4.2.3",typescript:"^4.0.5","url-search-params":"^0.10.0",webpack:"^4.44.2","webpack-dev-server":"^3.11.0"},browser:{"./lib/adapters/http.js":"./lib/adapters/xhr.js"},jsdelivr:"dist/axios.min.js",unpkg:"dist/axios.min.js",typings:"./index.d.ts",dependencies:{"follow-redirects":"^1.14.0"},bundlesize:[{path:"./dist/axios.min.js",threshold:"5kB"}]},q={};["object","boolean","number","function","string","symbol"].forEach(function(e,t){q[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});var z={},J=F.version.split(".");function M(e,t){for(var n=t?t.split("."):J,r=e.split("."),o=0;o<3;o++){if(n[o]>r[o])return!0;if(n[o]<r[o])return!1}return!1}q.transitional=function(e,t,n){var r=t&&M(t);function o(e,t){return"[Axios v"+F.version+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,a,i){if(!1===e)throw new Error(o(a," has been removed in "+t));return r&&!z[a]&&(z[a]=!0,console.warn(o(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,a,i)}};var H={isOlderVersion:M,assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),o=r.length;o-- >0;){var a=r[o],i=t[a];if(i){var s=e[a],u=void 0===s||i(s,a,e);if(!0!==u)throw new TypeError("option "+a+" must be "+u)}else if(!0!==n)throw Error("Unknown option "+a)}},validators:q},W=H.validators;function V(e){this.defaults=e,this.interceptors={request:new j,response:new j}}V.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=D(this.defaults,e)).method=e.method?e.method.toLowerCase():this.defaults.method?this.defaults.method.toLowerCase():"get";var t=e.transitional;void 0!==t&&H.assertOptions(t,{silentJSONParsing:W.transitional(W.boolean,"1.0.0"),forcedJSONParsing:W.transitional(W.boolean,"1.0.0"),clarifyTimeoutError:W.transitional(W.boolean,"1.0.0")},!1);var n=[],o=!0;this.interceptors.request.forEach(function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(o=o&&t.synchronous,n.unshift(t.fulfilled,t.rejected))});var a,i=[];if(this.interceptors.response.forEach(function(e){i.push(e.fulfilled,e.rejected)}),!o){var s=[L,void 0];for(Array.prototype.unshift.apply(s,n),s=s.concat(i),a=r.resolve(e);s.length;)a=a.then(s.shift(),s.shift());return a}for(var u=e;n.length;){var c=n.shift(),f=n.shift();try{u=c(u)}catch(e){f(e);break}}try{a=L(u)}catch(e){return r.reject(e)}for(;i.length;)a=a.then(i.shift(),i.shift());return a},V.prototype.getUri=function(e){return e=D(this.defaults,e),k(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},g.forEach(["delete","get","head","options"],function(e){V.prototype[e]=function(t,n){return this.request(D(n||{},{method:e,url:t,data:(n||{}).data}))}}),g.forEach(["post","put","patch"],function(e){V.prototype[e]=function(t,n,r){return this.request(D(r||{},{method:e,url:t,data:n}))}});var X=V;function $(e){this.message=e}$.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},$.prototype.__CANCEL__=!0;var G=$;function K(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new r(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new G(e),t(n.reason))})}K.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},K.source=function(){var e;return{token:new K(function(t){e=t}),cancel:e}};var Z=K;function Q(e){var t=new X(e),n=f(X.prototype.request,t);return g.extend(n,X.prototype,t),g.extend(n,t),n}var Y=Q(R);Y.Axios=X,Y.create=function(e){return Q(D(Y.defaults,e))},Y.Cancel=G,Y.CancelToken=Z,Y.isCancel=_,Y.all=function(e){return r.all(e)},Y.spread=function(e){return function(t){return e.apply(null,t)}},Y.isAxiosError=function(e){return"object"==typeof e&&!0===e.isAxiosError};var ee=Y;ee.default=Y;var te=ee,ne={user:{},tokens:{},mode:"live"},re=function(e){var t={exports:{}};return function(e,t){var n;n=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(r){function o(){}function a(t,n,a){if("undefined"!=typeof document){"number"==typeof(a=e({path:"/"},o.defaults,a)).expires&&(a.expires=new Date(1*new Date+864e5*a.expires)),a.expires=a.expires?a.expires.toUTCString():"";try{var i=JSON.stringify(n);/^[\{\[]/.test(i)&&(n=i)}catch(e){}n=r.write?r.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var s="";for(var u in a)a[u]&&(s+="; "+u,!0!==a[u]&&(s+="="+a[u].split(";")[0]));return document.cookie=t+"="+n+s}}function i(e,n){if("undefined"!=typeof document){for(var o={},a=document.cookie?document.cookie.split("; "):[],i=0;i<a.length;i++){var s=a[i].split("="),u=s.slice(1).join("=");n||'"'!==u.charAt(0)||(u=u.slice(1,-1));try{var c=t(s[0]);if(u=(r.read||r)(u,c)||t(u),n)try{u=JSON.parse(u)}catch(e){}if(o[c]=u,e===c)break}catch(e){}}return e?o[e]:o}}return o.set=a,o.get=function(e){return i(e,!1)},o.getJSON=function(e){return i(e,!0)},o.remove=function(t,n){a(t,"",e(n,{expires:-1}))},o.defaults={},o.withConverter=n,o}(function(){})},e.exports=n()}(t),t.exports}();function oe(e){try{var t=e.split(".")[1].replace("-","+").replace("_","/");return JSON.parse(atob(t))}catch(e){console.error("Problem decoding JWT payload",e)}}function ae(e){try{if(!e)return!1;var t=oe(e);return new Date(1e3*t.exp)>new Date}catch(e){return!1}}function ie(e){var t,n;if(e){if("string"==typeof e)throw new Error(e);if(null!=e&&null!=(t=e.response)&&null!=(n=t.data)&&n.message)throw new Error(e.response.data.message);throw e}}var se=ne.user;function ue(e){return e.replace(/([^:]\/)\/+/g,"$1")}var ce=function(e,t,n){try{var o=ue(""+ne.baseUrl+e);return r.resolve(te.put(o,t,n))}catch(e){return r.reject(e)}},fe=function(e,t,n){try{var o=ue(""+ne.baseUrl+e);return r.resolve(te.post(o,t,n))}catch(e){return r.reject(e)}},de=function(e,t){try{var n=ue(""+ne.baseUrl+e);return r.resolve(te.get(n,t))}catch(e){return r.reject(e)}};function le(e,t,n){var r=n+"."+ne.tenantId;t=t||{secure:"live"===ne.mode,sameSite:"Lax"},"refresh"===n&&(t.sameSite="Strict"),re.set(r,e,t)}function he(e){var t,n;try{var r=window.location.pathname,o=window.location.hostname,a=o.split(".").slice(-2).join(".");t=[void 0,r,"/"],n=[void 0,o,"."+o,a,"."+a]}catch(e){t=[void 0,"/"],n=[void 0]}t.map(function(t){n.map(function(n){var r={};n&&(r.domain=n),t&&(r.path=t),re.remove(e,r)})})}function pe(){he(ne.tokens.accessTokenName),he(ne.tokens.idTokenName),he(ne.tokens.refreshTokenName),ne.tokens.accessToken=void 0,ne.tokens.idToken=void 0,ne.tokens.refreshToken=void 0,function(){for(var e in ne.user)"function"!=typeof ne.user[e]&&delete ne.user[e]}()}function ve(e){le(e.access.value,e.access.cookieOptions,"access"),le(e.id.value,e.id.cookieOptions,"id"),e.refresh&&e.refresh.value&&le(e.refresh.value,e.refresh.cookieOptions,"refresh"),ye()}function me(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var we=function(e){return r.resolve()},ge=function(){try{var e=me(function(){return r.resolve(function(){try{var e=re.get(ne.tokens.refreshTokenName);return r.resolve(me(function(){return r.resolve(de("/auth/refresh",{headers:{authorization:"Bearer "+e}})).then(function(e){var t=e.data;if(200!==e.status)throw new Error(t.message||"Problem with request");if(t.tokens)return ve(t.tokens),t;throw new Error("Problem setting cookies")})},function(e){ie(e)}))}catch(e){return r.reject(e)}}()).then(function(){})},function(e){console.warn("Refresh failed: "+e.message)});return r.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return r.reject(e)}};function ye(){["access","id","refresh"].map(function(e){try{var t=re.get(ne.tokens[e+"TokenName"]);ne.tokens[e+"Token"]=t,"id"===e&&t&&function(){if(!ne.tokens.idToken)return console.warn("Cannot define user: missing ID token");ne.user=ne.user||{};for(var e=oe(ne.tokens.idToken),t=0,n=["email","phoneNumber","username","name","image","data","confirmedAt","createdAt","updatedAt","mode","userId","userUuid","tenantId","isConfirmed"];t<n.length;t++){var r=n[t];if("update"===r)return;ne.user[r]=e[r]}}()}catch(t){console.warn("Problem setting "+e+" token.")}})}function ke(){return ae(ne.tokens.accessToken)}ne.tokens=ne.tokens||{},ne.tokens.refresh=ge;var be=ne.tokens,je=function(){try{return r.resolve(Ee()).then(function(e){return{isLoggedIn:e}})}catch(e){return r.reject(e)}},Ee=function(){return r.resolve(function(e,t){try{var n=!!ke()||!!ae(ne.tokens.refreshToken)&&r.resolve(ge()).then(function(){return ke()})}catch(e){return!1}return n&&n.then?n.then(void 0,function(){return!1}):n}())};function Te(e){if("object"==typeof window&&"object"==typeof window.location&&window.location.href&&!(window.location.href.indexOf(e+"=")<0))return decodeURIComponent(window.location.href.split(e+"=")[1].split("&")[0])}var xe=function(e){var t=e.redirect,n=e.data;!1!==t&&Ce(t||Te("redirect")||n.redirectTo||"/")};function Ce(e){if(e&&"object"==typeof document&&"object"==typeof window){try{document&&window}catch(e){return}var t=document.createElement("a");t.href=e,t.pathname!==window.location.pathname&&window.location.assign(""+t.pathname+t.hash+t.search)}}function Oe(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var Ne=function(e){var t=e.password,n=e.existingPassword;try{return r.resolve(Oe(function(){if(!ne.tokens.accessToken)throw new Error('updatePassword({ method: "jwt" }) was called without a JWT access token.');return r.resolve(ce("/auth/basic",{tenantId:ne.tenantId,password:t,existingPassword:n},{headers:{Authorization:"Bearer "+ne.tokens.accessToken}})).then(function(e){return e.data})},function(e){ie(e)}))}catch(e){return r.reject(e)}},Se=function(e){var t=e.uuid,n=e.token,o=e.password,a=e.redirect;try{return r.resolve(Oe(function(){if(n=n||Te("token"),t=t||Te("uuid"),!n||!t)throw new Error("Missing token or uuid");return r.resolve(ce("/auth/reset",{tenantId:ne.tenantId,uuid:t,token:n,password:o})).then(function(e){var t=e.data;if(t.tokens)return ve(t.tokens),xe({redirect:a,data:t}),t;throw new Error("There was a problem resetting your password. Please try again.")})},function(e){ie(e)}))}catch(e){return r.reject(e)}},Ue=function(e){var t=e.method,n=e.password,o=e.existingPassword,a=e.uuid,i=e.token,s=e.redirect;try{switch(t){case"link":return Se({uuid:a,token:i,password:n,redirect:s});case"jwt":return Ne({password:n,existingPassword:o});default:if(i=i||Te("token"),(a=a||Te("uuid"))&&i)return Se({uuid:a,token:i,password:n,redirect:s});if(ne.tokens.accessToken)return Ne({password:n,existingPassword:o});throw new Error("updatePassword() was called without link credentials (token & uuid) or a JWT access token.")}}catch(e){return r.reject(e)}},Ie=Ue;function Pe(e){var t=e.provider,n=e.redirect;if(!t)throw new Error("Missing provider");var r=function(e){var t=e.provider,n=e.redirect;if(!t)throw new Error("Missing provider");if(!ne.tenantId)throw new Error("Missing tenantId");var r=ne.baseUrl+"auth/"+t+"/login?tenant_id="+ne.tenantId+"&origin="+window.location.origin,o=n||Te("redirect");return!1===n&&(o="object"==typeof document&&document.location.pathname),o&&(r+="&redirect="+encodeURIComponent(o)),r}({provider:t,redirect:n});window.location.assign(r)}function Re(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var Ae=function(e){var t=e.email,n=e.name,o=e.username,a=e.userData,i=e.options;try{return r.resolve(Re(function(){return r.resolve(fe("/auth/link",{email:t,name:n,username:o,data:a,options:i,tenantId:ne.tenantId})).then(function(e){return e.data})},function(e){ie(e)}))}catch(e){return r.reject(e)}};function _e(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}function Be(e){var t=e.channel,n=e.phoneNumber,r=e.email;if("sms"!==t&&"email"!==t)throw new Error("Invalid channel");if("sms"===t&&!n)throw new Error('SMS verification code requires "phoneNumber"');if("email"===t&&!r)throw new Error('Email verification code requires "email"')}var Le=function(e){var t=e.channel,n=void 0===t?"sms":t,o=e.phoneNumber,a=e.email,i=e.name,s=e.username,u=e.data;try{return r.resolve(_e(function(){return Be({channel:n,phoneNumber:o,email:a}),r.resolve(fe("/auth/code",{channel:n,email:a,phoneNumber:o,name:i,username:s,data:u,tenantId:ne.tenantId})).then(function(e){return e.data})},function(e){ie(e)}))}catch(e){return r.reject(e)}};function De(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}function Fe(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}var qe=/((^127\.)|(^10\.)|(^172\.1[6-9]\.)|(^172\.2[0-9]\.)|(^172\.3[0-1]\.)|(^192\.168\.))\d{1,3}\.\d{1,3}/g,ze=function(){try{var e=function(e,t){try{var n=r.resolve(de("/tenants/"+ne.tenantId+"/mode")).then(function(e){Je.value=e.data.mode||"test",Je.reason=He(Je.value),ne.mode=Je.value})}catch(e){return t()}return n&&n.then?n.then(void 0,t):n}(0,function(){Je.value="test",ne.mode=Je.value});return r.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return r.reject(e)}},Je={value:"live",reason:void 0,setMode:ze};function Me(){var e=function(e){try{var t=window.location.hostname;return!(!t.match(/localhost/g)&&!t.match(qe))}catch(e){return!0}}()||!function(){try{return"https:"===window.location.protocol}catch(e){return!1}}()?"test":"live";Je.value=e,Je.reason=He(e),ne.mode=e}function He(e){try{return"live"===e?"domain":"http:"===window.location.protocol?"http":"https:"!==window.location.protocol?"protocol":"domain"}catch(e){}}Me(),ne.user.update=function(e){try{return!e||Object.keys(e).length<1?r.resolve(console.warn("Missing user properties to update")):r.resolve(ce("/self",e,{headers:{authorization:"Bearer "+ne.tokens.accessToken}})).then(function(){return r.resolve(ge()).then(function(){return ne.user})})}catch(e){return r.reject(e)}},ne.user.hasRole=function(e,t){var n=(void 0===t?{}:t).tenantId;try{if(!ne.tokens.accessToken||!ne.tenantId)return!1;var r=oe(ne.tokens.accessToken).authorization;return!!r&&!(!r[n=n||ne.tenantId]||!r[n].roles)&&r[n].roles.indexOf(e)>-1}catch(e){return!1}},ne.user.updatePassword=Ue,ne.user.getTotp=function(){try{return r.resolve(De(function(){if(!ne.tokens.accessToken)throw new Error("getTotp() was called without a JWT access token.");return r.resolve(de("/auth/totp",{headers:{Authorization:"Bearer "+ne.tokens.accessToken}})).then(function(e){return e.data})},function(e){ie(e)}))}catch(e){return r.reject(e)}};var We=[],Ve=!1,Xe={addInitCallback:function(e){e&&"function"==typeof e&&We.push(e)},init:function(e,t){if(void 0===t&&(t={}),!e)return console.warn("Userfront initialized without tenantId");if(ne.tenantId=e,ne.baseUrl=t.baseUrl||"https://api.userfront.com/v0/",ne.baseUrl.endsWith("/")||(ne.baseUrl+="/"),t.domain){ne.domain=t.domain;var n="https://"+ne.domain;te.defaults.headers.common["x-application-id"]=n,te.defaults.headers.common["x-origin"]=n}ne.tokens=ne.tokens||{},ne.tokens.accessTokenName="access."+ne.tenantId,ne.tokens.idTokenName="id."+ne.tenantId,ne.tokens.refreshTokenName="refresh."+ne.tenantId,ye(),Me();try{We.length>0&&We.forEach(function(t){t&&"function"==typeof t&&t({tenantId:e})}),We=[]}catch(e){}},registerUrlChangedEventListener:function(){if(!Ve){Ve=!0;try{history.pushState=(e=history.pushState,function(){var t=e.apply(this,arguments);return window.dispatchEvent(new Event("pushstate")),window.dispatchEvent(new Event("urlchanged")),t}),history.replaceState=function(e){return function(){var t=e.apply(this,arguments);return window.dispatchEvent(new Event("replacestate")),window.dispatchEvent(new Event("urlchanged")),t}}(history.replaceState),window.addEventListener("popstate",function(){window.dispatchEvent(new Event("urlchanged"))})}catch(e){}var e}},logout:function(e){var t=void 0===e?{}:e,n=t.method,o=t.redirect;try{if("saml"===n)return function(){try{if(!ne.tokens.accessToken)throw new Error("Please log in to authorize your logout request.");var e=Fe(function(){return r.resolve(de("/auth/saml/idp/token",{headers:{authorization:"Bearer "+ne.tokens.accessToken}})).then(function(e){window.location.assign(ne.baseUrl+"auth/saml/idp/logout?tenant_id="+ne.tenantId+"&token="+e.data.token+"&uuid="+ne.user.userUuid)})},function(e){ie(e)});return r.resolve(e&&e.then?e.then(function(){}):void 0)}catch(e){return r.reject(e)}}();if(!ne.tokens.accessToken)return r.resolve(pe());var a=Fe(function(){return r.resolve(de("/auth/logout",{headers:{authorization:"Bearer "+ne.tokens.accessToken}})).then(function(e){var t=e.data;pe(),xe({redirect:o,data:t})})},function(){pe()});return r.resolve(a&&a.then?a.then(function(){}):void 0)}catch(e){return r.reject(e)}},mode:Je,setMode:ze,refresh:function(e,t,n){try{console.warn("Userfront.refresh() is deprecated and will be removed. Please use Userfront.tokens.refresh() instead.")}catch(e){}return ge()},login:function(e){var t=void 0===e?{}:e,n=t.method,o=t.userId,a=t.userUuid,i=t.email,s=t.username,u=t.emailOrUsername,c=t.phoneNumber,f=t.password,d=t.token,l=t.uuid,h=t.totpCode,p=t.backupCode,v=t.channel,m=t.verificationCode,w=t.redirect;try{if(!n)throw new Error('Userfront.login called without "method" property.');switch(n){case"apple":case"azure":case"facebook":case"github":case"google":case"linkedin":return r.resolve(Pe({provider:n,redirect:w}));case"password":return r.resolve(function(e){var t=e.email,n=e.username,o=e.emailOrUsername,a=e.password,i=e.redirect;try{return r.resolve(Oe(function(){return r.resolve(fe("/auth/basic",{tenantId:ne.tenantId,emailOrUsername:t||n||o,password:a})).then(function(e){var t,n=e.data;function o(e){if(t)return e;if(n.hasOwnProperty("firstFactorCode"))return n;throw new Error("Please try again.")}var a=function(){if(n.hasOwnProperty("tokens"))return ve(n.tokens),r.resolve(we()).then(function(){return xe({redirect:i,data:n}),t=1,n})}();return a&&a.then?a.then(o):o(a)})},function(e){ie(e)}))}catch(e){return r.reject(e)}}({email:i,username:s,emailOrUsername:u,password:f,redirect:w}));case"passwordless":return r.resolve(Ae({email:i}));case"link":return r.resolve(function(e){var t=void 0===e?{}:e,n=t.token,o=t.uuid,a=t.redirect;try{return r.resolve(Re(function(){if(n=n||Te("token"),o=o||Te("uuid"),n&&o)return r.resolve(ce("/auth/link",{token:n,uuid:o,tenantId:ne.tenantId})).then(function(e){var t,n=e.data;function o(e){if(t)return e;if(n.hasOwnProperty("firstFactorCode"))return n;throw new Error("Problem logging in.")}var i=function(){if(n.hasOwnProperty("tokens"))return ve(n.tokens),r.resolve(we()).then(function(){return xe({redirect:a,data:n}),t=1,n})}();return i&&i.then?i.then(o):o(i)})},function(e){ie(e)}))}catch(e){return r.reject(e)}}({token:d,uuid:l,redirect:w}));case"totp":return r.resolve(function(e){var t=void 0===e?{}:e,n=t.totpCode,o=t.backupCode,a=t.userId,i=t.userUuid,s=t.emailOrUsername,u=t.email,c=t.username,f=t.phoneNumber,d=t.redirect;try{return r.resolve(De(function(){if(n||o)return r.resolve(fe("/auth/totp",{totpCode:n,backupCode:o,userId:a,userUuid:i,emailOrUsername:s,email:u,username:c,phoneNumber:f,tenantId:ne.tenantId})).then(function(e){var t,n=e.data;function o(e){if(t)return e;if(n.hasOwnProperty("firstFactorCode"))return n;throw new Error("Problem logging in.")}var a=function(){if(n.hasOwnProperty("tokens"))return ve(n.tokens),r.resolve(we()).then(function(){return xe({redirect:d,data:n}),t=1,n})}();return a&&a.then?a.then(o):o(a)})},function(e){ie(e)}))}catch(e){return r.reject(e)}}({totpCode:h,backupCode:p,userId:o,userUuid:a,emailOrUsername:u,email:i,username:s,phoneNumber:c,redirect:w}));case"verificationCode":return r.resolve(function(e){var t=void 0===e?{}:e,n=t.channel,o=t.verificationCode,a=t.email,i=t.phoneNumber,s=t.redirect;try{return r.resolve(_e(function(){return Be({channel:n,phoneNumber:i,email:a}),r.resolve(ce("/auth/code",{channel:n,verificationCode:o,email:a,phoneNumber:i,tenantId:ne.tenantId})).then(function(e){var t,n=e.data;function o(e){if(t)return e;if(n.hasOwnProperty("firstFactorCode"))return n;throw new Error("Problem logging in.")}var a=function(){if(n.hasOwnProperty("tokens"))return ve(n.tokens),r.resolve(we()).then(function(){return xe({redirect:s,data:n}),t=1,n})}();return a&&a.then?a.then(o):o(a)})},function(e){ie(e)}))}catch(e){return r.reject(e)}}({channel:v,email:i,phoneNumber:c,verificationCode:m,redirect:w}));case"saml":return r.resolve(function(){try{return r.resolve(function(e,t){try{var n=ne.tokens.accessToken?r.resolve(de("/auth/saml/idp/token",{headers:{authorization:"Bearer "+ne.tokens.accessToken}})).then(function(e){window.location.assign(ne.baseUrl+"auth/saml/idp/login?tenant_id="+ne.tenantId+"&token="+e.data.token+"&uuid="+ne.user.userUuid)}):console.warn("Cannot complete SAML login without access token")}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}(0,function(e){ie(e)}))}catch(e){return r.reject(e)}}());default:throw new Error('Userfront.login called with invalid "method" property.')}}catch(e){return r.reject(e)}},resetPassword:Ie,updatePassword:Ue,sendLoginLink:function(e){try{return r.resolve(Re(function(){return r.resolve(fe("/auth/link",{email:e,tenantId:ne.tenantId})).then(function(e){return e.data})},function(e){ie(e)}))}catch(e){return r.reject(e)}},sendResetLink:function(e){try{return r.resolve(Oe(function(){return r.resolve(fe("/auth/reset/link",{email:e,tenantId:ne.tenantId})).then(function(e){return e.data})},function(e){ie(e)}))}catch(e){return r.reject(e)}},sendVerificationCode:Le,signup:function(e){var t=void 0===e?{}:e,n=t.method,o=t.email,a=t.username,i=t.phoneNumber,s=t.name,u=t.data,c=t.password,f=t.channel,d=t.redirect;try{if(!n)throw new Error('Userfront.signup called without "method" property.');switch(n){case"apple":case"azure":case"facebook":case"github":case"google":case"linkedin":return r.resolve(Pe({provider:n,redirect:d}));case"password":return r.resolve(function(e){var t=void 0===e?{}:e,n=t.username,o=t.name,a=t.email,i=t.password,s=t.userData,u=t.redirect;try{return r.resolve(Oe(function(){return r.resolve(fe("/auth/create",{tenantId:ne.tenantId,username:n,name:o,email:a,password:i,data:s})).then(function(e){var t=e.data;if(t.tokens)return ve(t.tokens),r.resolve(we()).then(function(){return xe({redirect:u,data:t}),t});throw new Error("Please try again.")})},function(e){ie(e)}))}catch(e){return r.reject(e)}}({username:a,name:s,email:o,password:c,userData:u,redirect:d}));case"passwordless":return r.resolve(Ae({email:o,name:s,username:a,userData:u}));case"verificationCode":return r.resolve(Le({channel:f,email:o,phoneNumber:i,name:s,username:a,data:u}));default:throw new Error('Userfront.signup called with invalid "method" property.')}}catch(e){return r.reject(e)}},store:ne,tokens:be,accessToken:function(){return ne.tokens.accessToken=re.get(ne.tokens.accessTokenName),ne.tokens.accessToken},idToken:function(){return ne.tokens.idToken=re.get(ne.tokens.idTokenName),ne.tokens.idToken},getSession:je,redirectIfLoggedIn:function(e){var t=(void 0===e?{}:e).redirect;try{return r.resolve(je()).then(function(e){if(!e.isLoggedIn)return pe();if(t)return Ce(t);if(Te("redirect"))return Ce(Te("redirect"));var n=function(e,t){try{var n=r.resolve(de("/self",{headers:{authorization:"Bearer "+ne.tokens.accessToken}})).then(function(e){var t=e.data;t.tenant&&t.tenant.loginRedirectPath&&Ce(t.tenant.loginRedirectPath)})}catch(e){return t()}return n&&n.then?n.then(void 0,t):n}(0,function(){pe()});return n&&n.then?n.then(function(){}):void 0})}catch(e){return r.reject(e)}},redirectIfLoggedOut:function(e){var t=(void 0===e?{}:e).redirect;try{return r.resolve(je()).then(function(e){if(!e.isLoggedIn)return pe(),t?Ce(t):Te("redirect")?Ce(Te("redirect")):void 0})}catch(e){return r.reject(e)}},user:se};return Xe});
//# sourceMappingURL=userfront-core.ie11.umd.js.map
